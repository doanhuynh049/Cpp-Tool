<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>tconn.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.12 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; </center>
<hr><h1>tconn.h</h1><div class="fragment"><pre>00001 <font class="comment">/*</font>
00002 <font class="comment"> * Copyright (c) 1991-2006 TIBCO Software Inc.</font>
00003 <font class="comment"> * All rights reserved.</font>
00004 <font class="comment"> * For more information, please contact:</font>
00005 <font class="comment"> * TIBCO Software Inc., Palo Alto, California, USA</font>
00006 <font class="comment"> *</font>
00007 <font class="comment"> * $Id: //dev/packages/tpsi/cpsi/dev/68/src/rtworks/tconn.h#1 $</font>
00008 <font class="comment"> */</font>
00009 
00010 <font class="preprocessor">#ifndef _T_CONN_HH_</font>
00011 <font class="preprocessor"></font><font class="preprocessor">#define _T_CONN_HH_</font>
00012 <font class="preprocessor"></font>
00013 <font class="preprocessor">#include &lt;rtworks/ipc.h&gt;</font>
00014 <font class="preprocessor">#include &lt;rtworks/tcallbck.h&gt;</font>
00015 
00016 <font class="keyword">namespace </font>SmartSockets {
00017 
00018   <font class="keyword">class </font>T_IPCX_API TipcMsg;
00019   <font class="keyword">class </font>T_IPCX_API TipcMt;
00020 
<a name="l00027"></a><a class="code" href="classSmartSockets_1_1TipcConnException.html">00027</a>   <font class="keyword">class </font>T_IPCX_API TipcConnException : <font class="keyword">public</font> TipcException {
00028 
00029   <font class="keyword">public</font>:
<a name="l00033"></a><a class="code" href="classSmartSockets_1_1TipcConnException.html#a0">00033</a>     TipcConnException () {};
00034 
<a name="l00038"></a><a class="code" href="classSmartSockets_1_1TipcConnException.html#a1">00038</a>     <font class="keyword">virtual</font> ~TipcConnException () <font class="keywordflow">throw</font>() {}
00039 
00040   };
00041 
00042 
<a name="l00046"></a><a class="code" href="classSmartSockets_1_1TipcConnSearchSelector.html">00046</a>   <font class="keyword">class </font>T_IPCX_API TipcConnSearchSelector {
00047   <font class="keyword">public</font>:
00048 
00055     <font class="keyword">typedef</font> bool (TipcConnSearchSelector::* Handler)
00056     (
00057     <font class="keyword">const</font> TipcConn &amp; conn,
00058     <font class="keyword">const</font> TipcMsg&amp; msg
00059     ) ;
00060 
00061 
00062 
00063     TipcConnSearchSelector();
00064 
00069     <font class="keywordtype">void</font> setHandler(Handler cbMethod);
00070 
00074     Handler getHandler();
00075 
00076 
00080     <font class="keyword">virtual</font> ~TipcConnSearchSelector() <font class="keywordflow">throw</font>();
00081 
00088     <font class="keyword">virtual</font> <font class="keywordtype">bool</font> onSearch
00089     (
00090     <font class="keyword">const</font> TipcConn &amp; conn,
00091     <font class="keyword">const</font> TipcMsg&amp; msg
00092     )  <font class="keywordflow">throw</font> () ;
00093 
00094     <font class="keyword">static</font>  T_BOOL T_ENTRY searchFuncDelegator
00095     (
00096     T_IPC_CONN connection,
00097     T_IPC_MSG  msg,
00098     T_PTR arg
00099     );
00100 
00101   <font class="keyword">private</font>:
00102 
00103     Handler _cbMethod;
00104 
00105   };
00106 
<a name="l00114"></a><a class="code" href="classSmartSockets_1_1TipcConn.html">00114</a>   <font class="keyword">class </font>T_IPCX_API TipcConn {
00115 
00116   <font class="keyword">protected</font>:
<a name="l00118"></a><a class="code" href="classSmartSockets_1_1TipcConn.html#n0">00118</a>     T_IPC_CONN _connection;
00119 
00120     <font class="keywordtype">bool</font> _destroy_flag;
00121 
00126     TipcConn(<font class="keywordtype">bool</font> do_nothing);
00127 
00128 
00140     <font class="keyword">static</font> <font class="keywordtype">void</font> T_ENTRY1 errorCbDelegator(T_IPC_CONN connection,
00141                                           T_IPC_CONN_ERROR_CB_DATA data,
00142                                           T_CB_ARG arg);
00143 
00144 
00156     <font class="keyword">static</font> <font class="keywordtype">void</font> T_ENTRY1 queueCbDelegator(T_IPC_CONN connection,
00157                                           T_IPC_CONN_QUEUE_CB_DATA data,
00158                                           T_CB_ARG arg);
00159 
00160 
00171     <font class="keyword">static</font> <font class="keywordtype">void</font> T_ENTRY1 messageCbDelegator(T_IPC_CONN connection,
00172                                             T_IPC_CONN_MSG_CB_DATA data,
00173                                             T_CB_ARG arg);
00174 
00175 
00186     <font class="keyword">static</font> <font class="keywordtype">void</font> T_ENTRY1 readCbDelegator(T_IPC_CONN connection,
00187                                          T_IPC_CONN_READ_CB_DATA data,
00188                                          T_CB_ARG arg);
00189 
00190 
00201     <font class="keyword">static</font> <font class="keywordtype">void</font> T_ENTRY1 encodeCbDelegator(T_IPC_CONN connection,
00202                                            T_IPC_CONN_ENCODE_CB_DATA data,
00203                                            T_CB_ARG arg);
00204 
00205 
00217     <font class="keyword">static</font> <font class="keywordtype">void</font> T_ENTRY1 decodeCbDelegator(T_IPC_CONN connection,
00218                                            T_IPC_CONN_DECODE_CB_DATA data,
00219                                            T_CB_ARG arg);
00220 
00221   <font class="keyword">public</font>:
00229     TipcConn() <font class="keywordflow">throw</font> (TipcException);
00230     TipcConn(T_IPC_CONN connection, <font class="keywordtype">bool</font> destroy_flag=<font class="keyword">true</font>)
00231     <font class="keywordflow">throw</font> (TipcException);
00233 
00235     <font class="keyword">virtual</font> ~TipcConn() <font class="keywordflow">throw</font>();
00236 
00237 
<a name="l00239"></a><a class="code" href="classSmartSockets_1_1TipcConn.html#a3">00239</a>     operator T_IPC_CONN() <font class="keyword">const</font> <font class="keywordflow">throw</font>()  { <font class="keywordflow">return</font> _connection;}
00240 
00241     <font class="comment">// The following methods will have TipcSrv equivalents</font>
00242 
00249     <font class="keyword">virtual</font> <font class="keywordtype">bool</font> check(T_IO_CHECK_MODE check_mode, real8 timeout)
00250     <font class="keywordflow">throw</font> (TipcException);
00251 
00256     <font class="keyword">virtual</font> <font class="keywordtype">void</font> flush() <font class="keywordflow">throw</font> (TipcException);
00257 
00266     <font class="keyword">virtual</font> int4 getAutoFlushSize() <font class="keyword">const</font> <font class="keywordflow">throw</font> (TipcException);
00267 
00268     <font class="keyword">virtual</font> <font class="keywordtype">void</font> setAutoFlushSize(int4 auto_flush_size)
00269     <font class="keywordflow">throw</font> (TipcException);
00271 
00279     <font class="keyword">virtual</font> <font class="keywordtype">long</font> getBlockMode() <font class="keyword">const</font> <font class="keywordflow">throw</font> (TipcException);
00280 
00281     <font class="keyword">virtual</font> <font class="keywordtype">void</font> setBlockMode(<font class="keywordtype">bool</font> block_mode)
00282     <font class="keywordflow">throw</font> (TipcException);
00284 
00285 
00293     <font class="keyword">virtual</font> real8 getTimeout(T_IPC_TIMEOUT timeout) <font class="keyword">const</font>
00294     <font class="keywordflow">throw</font> (TipcException);
00295 
00296     <font class="keyword">virtual</font> <font class="keywordtype">void</font> setTimeout(T_IPC_TIMEOUT timeout, real8  value)
00297     <font class="keywordflow">throw</font> (TipcException);
00299 
00305     <font class="keyword">virtual</font> sock getSocket() <font class="keyword">const</font> <font class="keywordflow">throw</font> (TipcException);
00306 
00312     <font class="keyword">virtual</font> int4 getNumQueued() <font class="keyword">const</font> <font class="keywordflow">throw</font> (TipcException);
00313 
00319     <font class="keyword">virtual</font> sock getXtSource() <font class="keyword">const</font> <font class="keywordflow">throw</font> (TipcException);
00320 
00325     <font class="keyword">virtual</font> <font class="keywordtype">void</font> keepAlive() <font class="keywordflow">throw</font> (TipcException);
00326 
00332     <font class="keyword">virtual</font> <font class="keywordtype">bool</font> mainLoop(real8 timeout = T_TIMEOUT_FOREVER)
00333     <font class="keywordflow">throw</font> (TipcException);
00334 
00341     <font class="keyword">virtual</font> <font class="keywordtype">void</font> insert(TipcMsg&amp; msg, int4 pos)
00342     <font class="keywordflow">throw</font> (TipcException);
00343 
00349     <font class="keyword">virtual</font> <font class="keywordtype">void</font> process(TipcMsg&amp; msg) <font class="keywordflow">throw</font> (TipcException);
00350 
00358     <font class="keywordtype">void</font> read(real8 timeout) <font class="keywordflow">throw</font> (TipcException);
00359 
00366     <font class="keyword">virtual</font> <font class="keywordtype">void</font> next(TipcMsg&amp; msg, real8 timeout)
00367     <font class="keywordflow">throw</font> (TipcException);
00368 
00369 
00377     <font class="keyword">virtual</font> <font class="keywordtype">bool</font> nextEx(TipcMsg&amp; msg, real8 timeout)
00378     <font class="keywordflow">throw</font> (TipcException);
00379 
00380 
00388     <font class="keyword">virtual</font> <font class="keywordtype">void</font> search(TipcMsg&amp; msg, TipcConnSearchSelector* selObj,
00389                         real8 timeout) <font class="keywordflow">throw</font> (TipcException);
00390 
00399     <font class="keyword">virtual</font> <font class="keywordtype">void</font> searchType(TipcMsg&amp; msg, TipcMt&amp; mt, real8 timeout)
00400     <font class="keywordflow">throw</font> (TipcException);
00401 
00410     <font class="keyword">virtual</font> <font class="keywordtype">void</font> send(<font class="keyword">const</font> TipcMsg&amp; msg, <font class="keywordtype">bool</font> rtserver_check=FALSE)
00411     <font class="keywordflow">throw</font> (TipcException);
00412 
00421     <font class="keyword">virtual</font> <font class="keywordtype">void</font> sendRpc(TipcMsg&amp; reply_msg, <font class="keyword">const</font> TipcMsg&amp; call_msg, real8 timeout)
00422     <font class="keywordflow">throw</font> (TipcException);
00423 
00424 
00425 <font class="preprocessor">#if defined(T_OS_WINDOWS)</font>
00426 <font class="preprocessor"></font>
00427     <font class="comment">/*</font>
00428 <font class="comment">     * The Microsoft Visual C++ compilers (4.2 and 5.0, and maybe earlier ones),</font>
00429 <font class="comment">     * have a bug that makes it impossible to use references as the last</font>
00430 <font class="comment">     * non-variable argument in a varargs list.  So, for Windows, we're just</font>
00431 <font class="comment">     * passing the TipcMt object by value (since it's not modified [really</font>
00432 <font class="comment">     * ought to be const, cie la vie...]).  Once this bug is fixed, or if</font>
00433 <font class="comment">     * you're using some other compiler, this ifdef can be removed.</font>
00434 <font class="comment">     */</font>
00435 
00443     <font class="keyword">virtual</font> <font class="keywordtype">void</font>     write(TipcMt mt, ...) <font class="keywordflow">throw</font> (TipcException);
00444     <font class="keyword">virtual</font> <font class="keywordtype">void</font>     writeVa(TipcMt mt, va_list var_arg_list)
00445     <font class="keywordflow">throw</font> (TipcException);
00447 <font class="preprocessor">#else</font>
00448 <font class="preprocessor"></font>    <font class="keywordtype">void</font>     write(TipcMt&amp; mt, ...) <font class="keywordflow">throw</font> (TipcException);
00449     <font class="keywordtype">void</font>     writeVa(TipcMt&amp; mt, va_list var_arg_list)
00450     <font class="keywordflow">throw</font> (TipcException);
00451 
00452 <font class="preprocessor">#endif //T_OS_WINDOWS</font>
00453 <font class="preprocessor"></font>
00454 
00460     <font class="keyword">virtual</font> <font class="keywordtype">void</font>  print(T_OUT_FUNC func = (T_OUT_FUNC) TutOut) <font class="keyword">const</font>
00461     <font class="keywordflow">throw</font> (TipcException);
00462 
00463     <font class="comment">// CALLBACKS</font>
00473 <font class="comment"></font>    <font class="keyword">virtual</font> CallBack&lt;MessageQueueCallBack&gt; * queueCbCreate(<font class="keyword">const</font> TipcMt&amp; mt,
00474                                                            MessageQueueCallBack *,
00475                                                            <font class="keywordtype">void</font>* arg = NULL)
00476     <font class="keywordflow">throw</font> (TipcException);
00477 
00478 
00487     <font class="keyword">virtual</font> CallBack &lt;ErrorCallBack&gt; * errorCbCreate(
00488                                                     ErrorCallBack * implementor,
00489                                                     <font class="keywordtype">void</font>* arg = NULL)
00490     <font class="keywordflow">throw</font> (TipcException);
00491 
00492 
00502     <font class="keyword">virtual</font> CallBack &lt;MessageCallBack&gt; * encryptCbCreate(
00503                                                         <font class="keyword">const</font> TipcMt &amp; mt,
00504                                                         MessageCallBack * implementor,
00505                                                         <font class="keywordtype">void</font>* arg = NULL)
00506     <font class="keywordflow">throw</font> (TipcException);
00507 
00508 
00518     <font class="keyword">virtual</font> CallBack &lt;MessageCallBack&gt; * decryptCbCreate(
00519                                                         <font class="keyword">const</font> TipcMt &amp; mt,
00520                                                         MessageCallBack * implementor,
00521                                                         <font class="keywordtype">void</font>* arg = NULL)
00522     <font class="keywordflow">throw</font> (TipcException);
00523 
00524 
00533     <font class="keyword">virtual</font> CallBack &lt;MessageCallBack&gt; * defaultCbCreate(
00534                                                         MessageCallBack * implementor,
00535                                                         <font class="keywordtype">void</font>* arg = NULL)
00536     <font class="keywordflow">throw</font> (TipcException);
00537 
00538 
00548     <font class="keyword">virtual</font> CallBack &lt;MessageCallBack&gt; * processCbCreate(
00549                                                         <font class="keyword">const</font> TipcMt &amp; mt,
00550                                                         MessageCallBack * implementor,
00551                                                         <font class="keywordtype">void</font>* arg = NULL)
00552     <font class="keywordflow">throw</font> (TipcException);
00553 
00554 
00564     <font class="keyword">virtual</font> CallBack &lt;MessageCallBack&gt; * readCbCreate(
00565                                                      <font class="keyword">const</font> TipcMt &amp; mt,
00566                                                      MessageCallBack * implementor,
00567                                                      <font class="keywordtype">void</font>* arg = NULL)
00568     <font class="keywordflow">throw</font> (TipcException);
00569 
00570 
00580     <font class="keyword">virtual</font> CallBack &lt;MessageCallBack&gt; * writeCbCreate(
00581                                                       <font class="keyword">const</font> TipcMt &amp; mt,
00582                                                       MessageCallBack * implementor,
00583                                                       <font class="keywordtype">void</font>* arg = NULL)
00584     <font class="keywordflow">throw</font> (TipcException);
00585 
00586 
00595     <font class="keyword">virtual</font> CallBack &lt;EncodeCallBack&gt; * encodeCbCreate(
00596                                                       EncodeCallBack * implementor,
00597                                                       <font class="keywordtype">void</font>* arg = NULL)
00598     <font class="keywordflow">throw</font> (TipcException);
00599 
00600 
00609     <font class="keyword">virtual</font> CallBack &lt;DecodeCallBack&gt; * decodeCbCreate(
00610                                                       DecodeCallBack * impleemntor,
00611                                                       <font class="keywordtype">void</font>* arg = NULL)
00612     <font class="keywordflow">throw</font> (TipcException);
00613 
00614 
00615     <font class="comment">// ---------------------------------------------------------------------</font>
00616     <font class="comment">//  Starred methods have RTserver (TipcSrv*) overrides</font>
00617     <font class="comment">// ---------------------------------------------------------------------</font>
00618 
00624     <font class="keyword">virtual</font> <font class="keyword">const</font> <font class="keywordtype">char</font> * getPeerUniqueSubject() <font class="keyword">const</font> <font class="keywordflow">throw</font> (TipcException);
00625 
00631     <font class="keyword">virtual</font> <font class="keyword">const</font> <font class="keywordtype">char</font> * getNode() <font class="keyword">const</font> <font class="keywordflow">throw</font> (TipcException);
00632 
00638     <font class="keyword">virtual</font> <font class="keyword">const</font> <font class="keywordtype">char</font> * getUser() <font class="keyword">const</font> <font class="keywordflow">throw</font> (TipcException);
00639 
00645     <font class="keyword">virtual</font> int4 getPid() <font class="keyword">const</font> <font class="keywordflow">throw</font> (TipcException);
00646 
00652     <font class="keyword">virtual</font> <font class="keyword">const</font> <font class="keywordtype">char</font> * getArch() <font class="keyword">const</font> <font class="keywordflow">throw</font> (TipcException);
00653 
00659     <font class="keyword">virtual</font> <font class="keywordtype">void</font> lock() <font class="keywordflow">throw</font> (TipcException);
00660 
00661     <font class="keyword">virtual</font> <font class="keywordtype">void</font> unlock() <font class="keywordflow">throw</font> (TipcException);
00663 
00664     <font class="comment">// -- GMD --</font>
00665 
00670     <font class="keyword">virtual</font> <font class="keywordtype">void</font> gmdFileCreate() <font class="keywordflow">throw</font> (TipcException);
00671 
00677     <font class="keyword">virtual</font> <font class="keywordtype">void</font> gmdFileDelete() <font class="keywordflow">throw</font> (TipcException);
00678 
00684     <font class="keyword">virtual</font> <font class="keywordtype">void</font> gmdResend() <font class="keywordflow">throw</font> (TipcException);
00685 
00692     <font class="keyword">virtual</font> <font class="keywordtype">void</font> gmdMsgDelete(TipcMsg&amp; msg) <font class="keywordflow">throw</font> (TipcException);
00693 
00699     <font class="keyword">virtual</font> <font class="keywordtype">void</font> gmdMsgResend(TipcMsg&amp; msg) <font class="keywordflow">throw</font> (TipcException);
00700 
00708     <font class="keyword">virtual</font> uint4 getGmdMaxSize() <font class="keyword">const</font> <font class="keywordflow">throw</font> (TipcException);
00709     <font class="keyword">virtual</font> <font class="keywordtype">void</font> setGmdMaxSize(uint4 gmd_max_size)
00710     <font class="keywordflow">throw</font> (TipcException);
00712 
00719     <font class="keyword">const</font> <font class="keywordtype">char</font> * getGmdDir() <font class="keyword">const</font>
00720     <font class="keywordflow">throw</font> (TipcException);
00721 
00728     <font class="keyword">virtual</font> int4 getGmdNumPending() <font class="keyword">const</font> <font class="keywordflow">throw</font> (TipcException);
00729 
00743     <font class="keyword">virtual</font> int4 trafficGetBytesRecv() <font class="keyword">const</font> <font class="keywordflow">throw</font> (TipcException);
00744 
00751     <font class="keyword">virtual</font> int8 trafficGetBytesRecv8() <font class="keyword">const</font> <font class="keywordflow">throw</font> (TipcException);
00752 
00772     <font class="keyword">virtual</font> int4 trafficGetBytesSent() <font class="keyword">const</font> <font class="keywordflow">throw</font> (TipcException);
00773 
00786     <font class="keyword">virtual</font> int8 trafficGetBytesSent8() <font class="keyword">const</font> <font class="keywordflow">throw</font> (TipcException);
00787 
00801     <font class="keyword">virtual</font> int4 trafficGetMsgsRecv() <font class="keyword">const</font> <font class="keywordflow">throw</font> (TipcException);
00802 
00809     <font class="keyword">virtual</font> int8 trafficGetMsgsRecv8() <font class="keyword">const</font> <font class="keywordflow">throw</font> (TipcException);
00810 
00830     <font class="keyword">virtual</font> int4 trafficGetMsgsSent() <font class="keyword">const</font> <font class="keywordflow">throw</font> (TipcException);
00831 
00844     <font class="keyword">virtual</font> int8 trafficGetMsgsSent8() <font class="keyword">const</font> <font class="keywordflow">throw</font> (TipcException);
00845 
00852     <font class="keyword">virtual</font> int4 bufferGetReadSize() <font class="keyword">const</font> <font class="keywordflow">throw</font> (TipcException);
00853 
00860     <font class="keyword">virtual</font> int4 bufferGetWriteSize() <font class="keyword">const</font> <font class="keywordflow">throw</font> (TipcException);
00861   };
00862 
00863 
<a name="l00873"></a><a class="code" href="classSmartSockets_1_1TipcConnServer.html">00873</a>   <font class="keyword">class </font>T_IPCX_API TipcConnServer : <font class="keyword">public</font> TipcConn {
00874 
00875   <font class="keyword">public</font>:
00884     TipcConnServer(<font class="keyword">const</font> <font class="keywordtype">char</font> * link_name) <font class="keywordflow">throw</font> (TipcException);
00885     TipcConnServer(T_IPC_CONN connection, <font class="keywordtype">bool</font> destroy_flag=TRUE)
00886     <font class="keywordflow">throw</font> (TipcException);
00888 
00890     <font class="keyword">virtual</font> ~TipcConnServer()  <font class="keywordflow">throw</font>();
00891 
00899     <font class="keyword">virtual</font> TipcConn *accept() <font class="keywordflow">throw</font> (TipcException);
00900   };
00901 
<a name="l00910"></a><a class="code" href="classSmartSockets_1_1TipcConnClient.html">00910</a>   <font class="keyword">class </font>T_IPCX_API TipcConnClient : <font class="keyword">public</font> TipcConn {
00911 
00912   <font class="keyword">public</font>:
<a name="l00921"></a><a class="code" href="classSmartSockets_1_1TipcConnClient.html#a0">00921</a>     TipcConnClient() <font class="keywordflow">throw</font> () {}
00922     TipcConnClient(<font class="keyword">const</font> <font class="keywordtype">char</font> * link_name) <font class="keywordflow">throw</font> (TipcException);
00923     TipcConnClient(T_IPC_CONN connection, <font class="keywordtype">bool</font> destroy_flag=<font class="keyword">true</font>)
00924     <font class="keywordflow">throw</font> (TipcException);
00926 
00928     <font class="keyword">virtual</font> ~TipcConnClient() <font class="keywordflow">throw</font>();
00929   };
00930 
00931 } <font class="comment">// namespace SmartSockets</font>
00932 <font class="preprocessor">#endif</font>
</font></pre></div><hr><address><small>Generated on Mon Apr 13 16:28:25 2009 by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.12 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2001</small></address>
</body>
</html>
